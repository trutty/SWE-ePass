extends ../../layout

block content
	p= message

	h1= title

	form(action='/course', method='post', class='k-content')
		div
			label(for='name')
				| Name:
				input#name(type='text', name='name')

		div
			label(for='year')
				| Year:
				input#year(type='text', name='year', 
					value= new Date().getFullYear())

		div
			label(for='students')
				| Students:
				select(name='students')
					each student in users
						option(value='#{student.id}') #{student.firstname} #{student.lastname}

		div#allStudents
		div#studentsInCourse

		script
			var alphabeticallyOrderedStudents = new kendo.data.HierarchicalDataSource({
				transport: {
					read: {
						url: '/api/students/az/4',
						dataType: 'json'
					}
				},
				schema: {
					model: {
						id: '_id'
					}
				}
			});

			var studentsInCourse = new kendo.data.HierarchicalDataSource({
				transport: {
					read: {
						url: '/api/students/course/#{course.id}',
						dataType: 'json'
					}
				}
			})

			$('#allStudents').kendoTreeView({
				dragAndDrop: true,
				dataSource: alphabeticallyOrderedStudents,
				dataTextField: 'lastname'
			}).data('kendoTreeView');


			$('#studentsInCourse').kendoTreeView({
				dragAndDrop: true,
				dataSource: studentsInCourse
			}).data('kendoTreeView');
